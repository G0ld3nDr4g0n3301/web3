<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html">

<h:head>
    <meta charset="UTF-8"/>
    <title>web lab 3</title>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js">

    </script>
    <h:outputStylesheet library="css" name="main_styles.css" />
    <h:outputScript library="js" name="main.js" />


</h:head>

<h:body style="background: url('#{request.contextPath}/resources/images/cover.jpg') fixed; background-size: cover;">
    <!-- Header -->
    <h:panelGroup>
        Думцев Виктор Сергеевич, P3212
    </h:panelGroup>
    <div>
        <!-- Graph and user data input section -->
        <h:panelGroup>
            <h:panelGroup layout="block">
                <canvas id="graphCanvas" width="650" height="650" class="graph"/>
            </h:panelGroup>

            <h:panelGroup>
                <button id="clearPointsBtn" class="btn" onclick="clickOnClearBtn()">
                    clear
                </button>
            </h:panelGroup>

            <!-- Input section -->
            <h:form id="input-from">

                <h:form id="rForm">
                    <h:outputText id="rValueLabel" value="R: #{rCoordinateBean.r}" />

                    <h:commandLink actionListener="#{rCoordinateBean.setR(1)}">
                        <h:outputText value="1" />
                        <f:ajax execute="rForm" render="rValueLabel"/>
                    </h:commandLink>
                    <h:commandLink actionListener="#{rCoordinateBean.setR(2)}">
                        <h:outputText value="2" />
                        <f:ajax execute="rForm" render="rValueLabel"/>
                    </h:commandLink>
                    <h:commandLink actionListener="#{rCoordinateBean.setR(3)}">
                        <h:outputText value="3" />
                        <f:ajax execute="rForm" render="rValueLabel"/>
                    </h:commandLink>
                    <h:commandLink actionListener="#{rCoordinateBean.setR(4)}">
                        <h:outputText value="4" />
                        <f:ajax execute="rForm" render="rValueLabel"/>
                    </h:commandLink>
                    <h:commandLink actionListener="#{rCoordinateBean.setR(5)}">
                        <h:outputText value="5" />
                        <f:ajax execute="rForm" render="rValueLabel"/>
                    </h:commandLink>
                </h:form>

                <h:form id="xForm">
                    <h:outputText id="xValueLabel" value="X: #{xCoordinateBean.x}" />
                    
                    <h:commandLink action="#{xCoordinateBean.setX(-4)}">
                        <h:outputText value="-4" />
                        <f:ajax execute="xForm" render="xValueLabel"/>
                    </h:commandLink>
                    <h:commandLink actionListener="#{xCoordinateBean.setX(-3)}">
                        <h:outputText value="-3" />
                        <f:ajax execute="xForm" render="xValueLabel"/>
                    </h:commandLink>
                    <h:commandLink actionListener="#{xCoordinateBean.setX(-2)}">
                        <h:outputText value="-2" />
                        <f:ajax execute="xForm" render="xValueLabel"/>
                    </h:commandLink>
                    <h:commandLink actionListener="#{xCoordinateBean.setX(-1)}">
                        <h:outputText value="-1" />
                        <f:ajax execute="xForm" render="xValueLabel"/>
                    </h:commandLink>
                    <h:commandLink actionListener="#{xCoordinateBean.setX(0)}">
                        <h:outputText value="0" />
                        <f:ajax execute="xForm" render="xValueLabel"/>
                    </h:commandLink>
                    <h:commandLink actionListener="#{xCoordinateBean.setX(1)}">
                        <h:outputText value="1" />
                        <f:ajax execute="xForm" render="xValueLabel"/>
                    </h:commandLink>
                    <h:commandLink actionListener="#{xCoordinateBean.setX(2)}">
                        <h:outputText value="2" />
                        <f:ajax execute="xForm" render="xValueLabel"/>
                    </h:commandLink>
                    <h:commandLink actionListener="#{xCoordinateBean.setX(3)}">
                        <h:outputText value="3" />
                        <f:ajax execute="xForm" render="xValueLabel"/>
                    </h:commandLink>
                    <h:commandLink actionListener="#{xCoordinateBean.setX(4)}">
                        <h:outputText value="4" />
                        <f:ajax execute="xForm" render="xValueLabel"/>
                    </h:commandLink>
                </h:form>

                <h:form id="yForm">
                    <h:outputLabel id="yValueLabel" value="Y: #{yCoordinateBean.y}" />
                    <h:inputText id="yValue" required="true" immediate="true" value="#{yCoordinateBean.y}" maxlength="8" />
                    <h:message for="yValue" />

                    <h:commandButton value="Check">
                        <f:ajax execute="@form"
                                listener="#{resultsControllerBean.addNewResult(xCoordinateBean.x, yCoordinateBean.y, rCoordinateBean.r)}"
                                render="@form results-table" />
                    </h:commandButton>
                </h:form>


            </h:form>
        </h:panelGroup>
    </div>

    <!-- Data table -->
    <h:panelGroup layout="block">
        <h:dataTable var="result" value="#{resultsControllerBean.results}" id="results-table">
            <h:column>
                <f:facet name="header">
                    <h:outputText value="x" />
                </f:facet>
                <h:outputText value="#{result.x}" />
            </h:column>

            <h:column>
                <f:facet name="header">
                    <h:outputText value="y" />
                </f:facet>
                <h:outputText value="#{result.y}" />
            </h:column>

            <h:column>
                <f:facet name="header">
                    <h:outputText value="r" />
                </f:facet>
                <h:outputText value="#{result.r}" />
            </h:column>

            <h:column>
                <f:facet name="header">
                    <h:outputText value="result" />
                </f:facet>
                <h:outputText value="#{result.result}" />
            </h:column>

        </h:dataTable>
    </h:panelGroup>


    <!-- Delete everything -->
    <h:form id="clear-points">
        <!-- Hidden btn for clearing all the points -->
        <h:commandLink id="clearPoints" styleClass="hidden" actionListener="#{resultsControllerBean.clearResults()}">
            <f:ajax execute="clear-points"
                    render="results-table"/>
        </h:commandLink>
    </h:form>

    <h:form id="graph-form">
        <h:inputHidden id="xGraphValue" value="#{coordinateHandlerBean.x}"/>
        <h:inputHidden id="yGraphValue" value="#{coordinateHandlerBean.y}"/>
        <h:commandLink id="handleClick" styleClass="hidden" actionListener="#{resultsControllerBean.addNewResult(coordinateHandlerBean.x, coordinateHandlerBean.y, rCoordinateBean.r)}">
            <f:ajax execute="graph-form"
                    render="xGraphValue yGraphValue results-table"/>
        </h:commandLink>
    </h:form>



    <!-- Redraw points on canvas -->
    <h:form id="update-radius">
        <h:inputHidden id="radius" value="#{rCoordinateBean.r}"/>
        <h:commandButton id="updateCanvas" styleClass="hidden">
            <f:ajax execute="@form"
                    listener="#{resultsControllerBean.updateCanvas(rCoordinateBean.r)}"
                    render="@form results-table"/>
        </h:commandButton>
    </h:form>

</h:body>


</html>